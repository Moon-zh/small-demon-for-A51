ZY	EQU	P1.0
YY	EQU	P1.1
ZJ	EQU	P1.2
SX	EQU	P1.3
CS2	EQU	P2.0
CS1	EQU	P2.1
E	EQU	P2.4

GW1	BIT	21H.0
GW2	BIT	21H.1
GW3	BIT	21H.2
GX	BIT	21H.3
GD1	BIT	21H.4
GD2	BIT	21H.5

DS0	EQU	30H
DS1	EQU	31H
DS2	EQU	32H
DS3	EQU	33H
DS4	EQU	34H
DS5	EQU	35H
DS6	EQU	36H
DS7	EQU	37H
SMG	EQU	P0
JSBZ	EQU	40H
G	EQU	P2.5
	ORG	00H
	AJMP	MAIN
	ORG	0BH
	AJMP	ZD
	ORG	30H
MAIN:	MOV	SP,#80H
	MOV	TMOD,#11H
	SETB	ET0
	SETB	TR0
	SETB	EA
	MOV	JSBZ,#0
	MOV	DS0,#0
	MOV	DS1,#0
	MOV	DS2,#0
	MOV	DS3,#0
	MOV	DS4,#0
	MOV	DS5,#0
	MOV	DS6,#0
	MOV	DS7,#0
	LCALL	FW
	LCALL	MY
MAI:	LCALL	QGW1
	AJMP	MAI

ZD:	PUSH	ACC
	PUSH	PSW
	LCALL	S245
	JNB	GW1,Z1
	MOV	DS7,#0
Z11:	JNB	GW2,Z2
	MOV	DS6,#0
Z12:	JNB	GW3,Z3
	MOV	DS5,#0
Z13:	JNB	GX,Z4
	MOV	DS4,#0
Z14:	JNB	GD1,Z5
	MOV	DS3,#0
Z15:	JNB	GD2,Z6
	MOV	DS2,#0


ZDC:	INC	JSBZ
	MOV	A,JSBZ
	CJNE	A,#5,ZDC1
	MOV	JSBZ,#0
	INC	DS0
	MOV	A,DS0
	CJNE	A,#10,ZDC1
	MOV	DS0,#0
	INC	DS1
	MOV	A,DS1
	CJNE	A,#10,ZDC1
	LCALL	S245
	JNB	GX,TZ
	SETB	ZY
	SETB	YY
	LCALL	SMQP
	AJMP	$
TZ:	LCALL	ZYX
	LCALL	S245
	JB	GW3,TZ
	SETB	ZY
	SETB	ZJ
	LCALL	SMQP
	AJMP	$


ZDC1:	POP	PSW
	POP	ACC
	RETI

Z1:	MOV	DS7,#1
	AJMP	Z11
Z2:	MOV	DS6,#1
	AJMP	Z12
Z3:	MOV	DS5,#1
	AJMP	Z13
Z4:	MOV	DS4,#1
	AJMP	Z14
Z5:	MOV	DS3,#1
	AJMP	Z15
Z6:	MOV	DS2,#1
	AJMP	ZDC


QGW1:	LCALL	YYX
	LCALL	S245
	JB	GW1,QGW1
	SETB	YY
	LCALL	XYX
	CLR	ZJ
	LCALL	SYX
Q1:	LCALL	ZYX
   	LCALL	S245
	JB	GW3,Q1
	SETB	ZY
	SETB	ZJ
	RET

ZYX:	CLR	ZY
	SETB	YY
	LCALL	MY
	RET
YYX:	CLR	YY
	SETB	ZY
	LCALL	MY
	RET
SYX:	SETB	SX
	LCALL	YS1S
	RET
XYX:	CLR	SX
	LCALL	YS1S
	RET
YS1s:	MOV	B,#160
YS1:	LCALL	MY
	DJNZ	B,YS1
	RET
FW:	SETB	ZJ
	LCALL	SYX
FW1:	LCALL	YYX
	LCALL	S245
	JB	GW1,FW1
	SETB	YY
	RET

S245:	CLR	G
	MOV	21H,P0
	SETB	G
	RET
MY:	MOV	DPTR,#TAB
	MOV	R1,#DS0
	MOV	R2,#0FEH
MA:	MOV	A,@R1
	MOVC	A,@A+DPTR
	INC	R1
	MOV	SMG,A
	CLR	E
	CLR	CS1
	SETB	E
	SETB	CS1
	MOV	A,R2
	MOV	SMG,A
	RL	A
	MOV	R2,A
	CLR	E
	CLR	CS2
	SETB	E
	SETB	CS2
	LCALL	SMYS
	LCALL	SMQP
	CJNE	R1,#38H,MA
	RET
SMYS:	MOV	R3,#0FFH
	DJNZ	R3,$
	RET
SMQP:	MOV	SMG,#0FFH
	CLR	E
	CLR	CS1
	SETB	E
	SETB	CS1
	CLR	E
	CLR	CS2
	SETB	E
	SETB	CS2
	RET
TAB:DB	0C0H,0F9H,0A4H,0B0H,99H,92H,82H,0F8H,80H,90H,0FFH


	END